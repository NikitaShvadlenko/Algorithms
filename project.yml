name: "Algorithms"

configs:
  AppStore Debug: debug
  AppStore Release: release

settings:
  base:
    DEBUG_INFORMATION_FORMAT: dwarf-with-dsym
    ENABLE_BITCODE: NO
    CLANG_ANALYZER_LOCALIZABILITY_NONLOCALIZED: YES
    CLANG_ANALYZER_LOCALIZABILITY_EMPTY_CONTEXT: YES
    CLANG_WARN_QUOTED_INCLUDE_IN_FRAMEWORK_HEADER: YES

options:
  deploymentTarget:
    iOS: 13.0
  preGenCommand: ./Scripts/autogenerated_files.sh

attributes:
  ORGANIZATIONNAME: "Nikita Shvadlenkko"

packages:

  # Local packages
  AlgorithmsFiles:
    path: Algorithms/Modules/AlgorithmsFiles

targets:
  Algorithms:
    platform: iOS
    type: application
    sources:
        - path: "Algorithms"
          excludes:
          - "Modules/**/"

    dependencies:
      - package: AlgorithmsFiles

    scheme:
      testTargets:
        - package: AlgorithmsFiles/AlgorithmsFilesTests

    settings:
      base:
        TARGETED_DEVICE_FAMILY: 1
        DISPLAY_NAME: "Algorithms"
        INFOPLIST_FILE: "Algorithms/Info.plist"
        OTHER_LDFLAGS: $(inherited) -ObjC
        DEVELOPMENT_TEAM: NikitaDevelopmentTeam
        PRODUCT_BUNDLE_IDENTIFIER: com.shvadShvad.Algorithms
        CODE_SIGN_STYLE: Manual
      configs:
        AppStore Debug:
          CODE_SIGN_IDENTITY: "Apple Development"
          PROVISIONING_PROFILE_SPECIFIER: "Algorithms Development"
        AppStore Release:
          CODE_SIGN_IDENTITY: "Apple Distribution"
          PROVISIONING_PROFILE_SPECIFIER: "Algorithms AppStore"

    preBuildScripts:
    - name: "Swiftlint"
      basedOnDependencyAnalysis: false
      script: |
              export PATH="$PATH:/opt/homebrew/bin"
              if which swiftlint >/dev/null; then
                swiftlint
              else
                echo "warning: SwiftLint not installed, download from https://github.com/realm/SwiftLint"
              fi